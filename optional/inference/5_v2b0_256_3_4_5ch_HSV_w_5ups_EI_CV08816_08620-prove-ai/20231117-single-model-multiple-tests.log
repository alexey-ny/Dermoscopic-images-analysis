2023-11-17 10:26:57,026 INFO ********************************************************************************
2023-11-17 10:26:57,026 INFO Begin logging
2023-11-17 10:26:57,057 INFO Dataset - ./jpeg/test_MSKCC_2020/1024/, metadata file - consecutive-biopsies-for-melanoma-across-year-2020_metadata_2023-11-03.csv
2023-11-17 10:26:57,063 INFO False    1178
True      117
Name: target, dtype: int64
2023-11-17 10:26:57,063 INFO 1th model out of 1: 5_v2b0_256_3_4_5ch_HSV_w_5ups_EI_CV08816_08620
2023-11-17 10:26:57,063 INFO   Image Size: 256, BS: 64, Rescaling flag: 2 (1 = to rescale)
2023-11-17 10:26:57,064 INFO   Fold: 1
2023-11-17 10:27:00,931 INFO     Predicting Validation without TTA...
2023-11-17 10:27:11,604 INFO     3 channels OOF AUC without TTA = 0.6042, F1 = 0.1925, precision = 0.1885, recall = 0.1966
2023-11-17 10:27:13,609 INFO     Predicting Validation without TTA...
2023-11-17 10:27:24,482 INFO     4 channels OOF AUC without TTA = 0.5993, F1 = 0.1801, precision = 0.1246, recall = 0.3248
2023-11-17 10:27:26,430 INFO     Predicting Validation without TTA...
2023-11-17 10:27:37,806 INFO     5 channels OOF AUC without TTA = 0.6098, F1 = 0.2044, precision = 0.1783, recall = 0.2393
2023-11-17 10:27:37,806 INFO   Fold: 2
2023-11-17 10:27:39,729 INFO     Predicting Validation without TTA...
2023-11-17 10:27:48,075 INFO     3 channels OOF AUC without TTA = 0.5721, F1 = 0.1553, precision = 0.1667, recall = 0.1453
2023-11-17 10:27:50,275 INFO     Predicting Validation without TTA...
2023-11-17 10:28:00,459 INFO     4 channels OOF AUC without TTA = 0.6472, F1 = 0.2210, precision = 0.1408, recall = 0.5128
2023-11-17 10:28:02,404 INFO     Predicting Validation without TTA...
2023-11-17 10:28:13,808 INFO     5 channels OOF AUC without TTA = 0.6528, F1 = 0.2278, precision = 0.1619, recall = 0.3846
2023-11-17 10:28:13,808 INFO   Fold: 3
2023-11-17 10:28:16,103 INFO     Predicting Validation without TTA...
2023-11-17 10:28:24,492 INFO     3 channels OOF AUC without TTA = 0.6165, F1 = 0.1526, precision = 0.1439, recall = 0.1624
2023-11-17 10:28:26,510 INFO     Predicting Validation without TTA...
2023-11-17 10:28:36,781 INFO     4 channels OOF AUC without TTA = 0.5849, F1 = 0.1531, precision = 0.1739, recall = 0.1368
2023-11-17 10:28:38,714 INFO     Predicting Validation without TTA...
2023-11-17 10:28:49,855 INFO     5 channels OOF AUC without TTA = 0.5798, F1 = 0.1595, precision = 0.1244, recall = 0.2222
2023-11-17 10:28:49,855 INFO   Fold: 4
2023-11-17 10:28:52,222 INFO     Predicting Validation without TTA...
2023-11-17 10:29:00,445 INFO     3 channels OOF AUC without TTA = 0.6098, F1 = 0.1964, precision = 0.1407, recall = 0.3248
2023-11-17 10:29:02,450 INFO     Predicting Validation without TTA...
2023-11-17 10:29:12,797 INFO     4 channels OOF AUC without TTA = 0.5952, F1 = 0.1651, precision = 0.1782, recall = 0.1538
2023-11-17 10:29:14,855 INFO     Predicting Validation without TTA...
2023-11-17 10:29:26,479 INFO     5 channels OOF AUC without TTA = 0.6206, F1 = 0.2176, precision = 0.1492, recall = 0.4017
2023-11-17 10:29:26,479 INFO   Fold: 5
2023-11-17 10:29:28,688 INFO     Predicting Validation without TTA...
2023-11-17 10:29:37,497 INFO     3 channels OOF AUC without TTA = 0.6461, F1 = 0.2190, precision = 0.1911, recall = 0.2564
2023-11-17 10:29:40,152 INFO     Predicting Validation without TTA...
2023-11-17 10:29:51,032 INFO     4 channels OOF AUC without TTA = 0.6469, F1 = 0.1992, precision = 0.1935, recall = 0.2051
2023-11-17 10:29:53,057 INFO     Predicting Validation without TTA...
2023-11-17 10:30:04,451 INFO     5 channels OOF AUC without TTA = 0.6515, F1 = 0.2101, precision = 0.1929, recall = 0.2308
2023-11-17 10:30:04,451 INFO Ensemble predictions
2023-11-17 10:30:04,453 INFO     3 channels OOF AUC without TTA = 0.6322, F1 = 0.1767, precision = 0.1939, recall = 0.1624
2023-11-17 10:30:04,455 INFO     Confusion matrix for 3 channels averaged
2023-11-17 10:30:04,455 INFO [[1099   98]
 [  79   19]]
2023-11-17 10:30:04,457 INFO     4 channels OOF AUC without TTA = 0.6385, F1 = 0.2213, precision = 0.2203, recall = 0.2222
2023-11-17 10:30:04,459 INFO     Confusion matrix for 4 channels averaged
2023-11-17 10:30:04,459 INFO [[1086   91]
 [  92   26]]
2023-11-17 10:30:04,461 INFO     5 channels OOF AUC without TTA = 0.6433, F1 = 0.2366, precision = 0.2037, recall = 0.2821
2023-11-17 10:30:04,462 INFO     Confusion matrix for 5 channels averaged
2023-11-17 10:30:04,462 INFO [[1049   84]
 [ 129   33]]
2023-11-17 10:30:04,463 INFO     Confusion matrix for 5 channels averaged on the subsample
2023-11-17 10:30:04,465 INFO [[1049    9]
 [ 129    6]]
2023-11-17 10:30:04,465 INFO     Subset 5 channels OOF AUC without TTA = 0.6077, F1 = 0.0800, precision = 0.0444, recall = 0.4000 

2023-11-17 10:30:06,755 INFO Dataset - ./jpeg/test_PROVe-AI/1024/, metadata file - prove-ai_metadata_2023-11-02.csv
2023-11-17 10:30:06,762 INFO False    508
True      95
Name: target, dtype: int64
2023-11-17 10:30:06,762 INFO 1th model out of 1: 5_v2b0_256_3_4_5ch_HSV_w_5ups_EI_CV08816_08620
2023-11-17 10:30:06,762 INFO   Image Size: 256, BS: 64, Rescaling flag: 2 (1 = to rescale)
2023-11-17 10:30:06,762 INFO   Fold: 1
2023-11-17 10:30:08,851 INFO     Predicting Validation without TTA...
2023-11-17 10:30:14,073 INFO     3 channels OOF AUC without TTA = 0.6545, F1 = 0.1583, precision = 0.2500, recall = 0.1158
2023-11-17 10:30:16,642 INFO     Predicting Validation without TTA...
2023-11-17 10:30:22,277 INFO     4 channels OOF AUC without TTA = 0.6794, F1 = 0.3636, precision = 0.3495, recall = 0.3789
2023-11-17 10:30:24,238 INFO     Predicting Validation without TTA...
2023-11-17 10:30:30,385 INFO     5 channels OOF AUC without TTA = 0.6992, F1 = 0.3145, precision = 0.3906, recall = 0.2632
2023-11-17 10:30:30,386 INFO   Fold: 2
2023-11-17 10:30:32,378 INFO     Predicting Validation without TTA...
2023-11-17 10:30:37,192 INFO     3 channels OOF AUC without TTA = 0.6130, F1 = 0.1408, precision = 0.2128, recall = 0.1053
2023-11-17 10:30:39,147 INFO     Predicting Validation without TTA...
2023-11-17 10:30:45,148 INFO     4 channels OOF AUC without TTA = 0.6472, F1 = 0.3438, precision = 0.2733, recall = 0.4632
2023-11-17 10:30:47,166 INFO     Predicting Validation without TTA...
2023-11-17 10:30:53,295 INFO     5 channels OOF AUC without TTA = 0.6916, F1 = 0.3402, precision = 0.3333, recall = 0.3474
2023-11-17 10:30:53,295 INFO   Fold: 3
2023-11-17 10:30:55,234 INFO     Predicting Validation without TTA...
2023-11-17 10:31:00,077 INFO     3 channels OOF AUC without TTA = 0.6214, F1 = 0.2013, precision = 0.2778, recall = 0.1579
2023-11-17 10:31:02,159 INFO     Predicting Validation without TTA...
2023-11-17 10:31:08,263 INFO     4 channels OOF AUC without TTA = 0.5615, F1 = 0.1203, precision = 0.2105, recall = 0.0842
2023-11-17 10:31:10,471 INFO     Predicting Validation without TTA...
2023-11-17 10:31:16,844 INFO     5 channels OOF AUC without TTA = 0.6000, F1 = 0.2112, precision = 0.2576, recall = 0.1789
2023-11-17 10:31:16,844 INFO   Fold: 4
2023-11-17 10:31:19,526 INFO     Predicting Validation without TTA...
2023-11-17 10:31:24,533 INFO     3 channels OOF AUC without TTA = 0.6562, F1 = 0.2299, precision = 0.2532, recall = 0.2105
2023-11-17 10:31:26,713 INFO     Predicting Validation without TTA...
2023-11-17 10:31:32,603 INFO     4 channels OOF AUC without TTA = 0.6758, F1 = 0.1391, precision = 0.4000, recall = 0.0842
2023-11-17 10:31:34,718 INFO     Predicting Validation without TTA...
2023-11-17 10:31:41,150 INFO     5 channels OOF AUC without TTA = 0.6858, F1 = 0.2927, precision = 0.2727, recall = 0.3158
2023-11-17 10:31:41,150 INFO   Fold: 5
2023-11-17 10:31:43,188 INFO     Predicting Validation without TTA...
2023-11-17 10:31:48,139 INFO     3 channels OOF AUC without TTA = 0.6433, F1 = 0.2133, precision = 0.2909, recall = 0.1684
2023-11-17 10:31:50,307 INFO     Predicting Validation without TTA...
2023-11-17 10:31:56,281 INFO     4 channels OOF AUC without TTA = 0.6491, F1 = 0.1912, precision = 0.3171, recall = 0.1368
2023-11-17 10:31:59,089 INFO     Predicting Validation without TTA...
2023-11-17 10:32:05,608 INFO     5 channels OOF AUC without TTA = 0.6686, F1 = 0.2207, precision = 0.3200, recall = 0.1684
2023-11-17 10:32:05,608 INFO Ensemble predictions
2023-11-17 10:32:05,610 INFO     3 channels OOF AUC without TTA = 0.6664, F1 = 0.1912, precision = 0.3171, recall = 0.1368
2023-11-17 10:32:05,611 INFO     Confusion matrix for 3 channels averaged
2023-11-17 10:32:05,611 INFO [[480  82]
 [ 28  13]]
2023-11-17 10:32:05,613 INFO     4 channels OOF AUC without TTA = 0.6706, F1 = 0.1752, precision = 0.2857, recall = 0.1263
2023-11-17 10:32:05,614 INFO     Confusion matrix for 4 channels averaged
2023-11-17 10:32:05,614 INFO [[478  83]
 [ 30  12]]
2023-11-17 10:32:05,616 INFO     5 channels OOF AUC without TTA = 0.6862, F1 = 0.2803, precision = 0.3548, recall = 0.2316
2023-11-17 10:32:05,617 INFO     Confusion matrix for 5 channels averaged
2023-11-17 10:32:05,617 INFO [[468  73]
 [ 40  22]]
2023-11-17 10:32:05,618 INFO     Confusion matrix for 5 channels averaged on the subsample
2023-11-17 10:32:05,620 INFO [[468  11]
 [ 40   4]]
2023-11-17 10:32:05,621 INFO     Subset 5 channels OOF AUC without TTA = 0.7415, F1 = 0.1356, precision = 0.0909, recall = 0.2667 

2023-11-17 10:32:07,943 INFO Dataset - ./jpeg/test_HIBA/1024/, metadata file - hiba-skin-lesions_metadata_2023-11-07.csv
2023-11-17 10:32:07,953 INFO False    1374
True      261
Name: target, dtype: int64
2023-11-17 10:32:07,954 INFO 1th model out of 1: 5_v2b0_256_3_4_5ch_HSV_w_5ups_EI_CV08816_08620
2023-11-17 10:32:07,954 INFO   Image Size: 256, BS: 64, Rescaling flag: 2 (1 = to rescale)
2023-11-17 10:32:07,954 INFO   Fold: 1
2023-11-17 10:32:10,203 INFO     Predicting Validation without TTA...
2023-11-17 10:32:21,448 INFO     3 channels OOF AUC without TTA = 0.7558, F1 = 0.4052, precision = 0.2750, recall = 0.7701
2023-11-17 10:32:23,588 INFO     Predicting Validation without TTA...
2023-11-17 10:32:36,450 INFO     4 channels OOF AUC without TTA = 0.7491, F1 = 0.3872, precision = 0.2565, recall = 0.7893
2023-11-17 10:32:38,783 INFO     Predicting Validation without TTA...
2023-11-17 10:32:53,380 INFO     5 channels OOF AUC without TTA = 0.7392, F1 = 0.3809, precision = 0.2538, recall = 0.7625
2023-11-17 10:32:53,381 INFO   Fold: 2
2023-11-17 10:32:55,620 INFO     Predicting Validation without TTA...
2023-11-17 10:33:06,295 INFO     3 channels OOF AUC without TTA = 0.7604, F1 = 0.4098, precision = 0.2840, recall = 0.7356
2023-11-17 10:33:09,244 INFO     Predicting Validation without TTA...
2023-11-17 10:33:22,138 INFO     4 channels OOF AUC without TTA = 0.7298, F1 = 0.3694, precision = 0.2415, recall = 0.7854
2023-11-17 10:33:24,406 INFO     Predicting Validation without TTA...
2023-11-17 10:33:39,003 INFO     5 channels OOF AUC without TTA = 0.7434, F1 = 0.3852, precision = 0.2540, recall = 0.7969
2023-11-17 10:33:39,003 INFO   Fold: 3
2023-11-17 10:33:41,201 INFO     Predicting Validation without TTA...
2023-11-17 10:33:51,397 INFO     3 channels OOF AUC without TTA = 0.7423, F1 = 0.3930, precision = 0.2682, recall = 0.7356
2023-11-17 10:33:53,644 INFO     Predicting Validation without TTA...
2023-11-17 10:34:06,466 INFO     4 channels OOF AUC without TTA = 0.7699, F1 = 0.3929, precision = 0.2646, recall = 0.7625
2023-11-17 10:34:08,643 INFO     Predicting Validation without TTA...
2023-11-17 10:34:23,138 INFO     5 channels OOF AUC without TTA = 0.7731, F1 = 0.4169, precision = 0.2966, recall = 0.7011
2023-11-17 10:34:23,138 INFO   Fold: 4
2023-11-17 10:34:25,448 INFO     Predicting Validation without TTA...
2023-11-17 10:34:36,837 INFO     3 channels OOF AUC without TTA = 0.7154, F1 = 0.3468, precision = 0.3660, recall = 0.3295
2023-11-17 10:34:39,142 INFO     Predicting Validation without TTA...
2023-11-17 10:34:52,518 INFO     4 channels OOF AUC without TTA = 0.7465, F1 = 0.2955, precision = 0.5714, recall = 0.1992
2023-11-17 10:34:54,839 INFO     Predicting Validation without TTA...
2023-11-17 10:35:09,213 INFO     5 channels OOF AUC without TTA = 0.6816, F1 = 0.2394, precision = 0.3913, recall = 0.1724
2023-11-17 10:35:09,214 INFO   Fold: 5
2023-11-17 10:35:11,534 INFO     Predicting Validation without TTA...
2023-11-17 10:35:21,899 INFO     3 channels OOF AUC without TTA = 0.7415, F1 = 0.3979, precision = 0.2722, recall = 0.7395
2023-11-17 10:35:24,140 INFO     Predicting Validation without TTA...
2023-11-17 10:35:37,222 INFO     4 channels OOF AUC without TTA = 0.7297, F1 = 0.3847, precision = 0.2586, recall = 0.7510
2023-11-17 10:35:39,465 INFO     Predicting Validation without TTA...
2023-11-17 10:35:54,351 INFO     5 channels OOF AUC without TTA = 0.7264, F1 = 0.3757, precision = 0.2497, recall = 0.7586
2023-11-17 10:35:54,351 INFO Ensemble predictions
2023-11-17 10:35:54,354 INFO     3 channels OOF AUC without TTA = 0.7650, F1 = 0.4107, precision = 0.2891, recall = 0.7088
2023-11-17 10:35:54,356 INFO     Confusion matrix for 3 channels averaged
2023-11-17 10:35:54,357 INFO [[919  76]
 [455 185]]
2023-11-17 10:35:54,359 INFO     4 channels OOF AUC without TTA = 0.7643, F1 = 0.3971, precision = 0.2709, recall = 0.7433
2023-11-17 10:35:54,360 INFO     Confusion matrix for 4 channels averaged
2023-11-17 10:35:54,360 INFO [[852  67]
 [522 194]]
2023-11-17 10:35:54,362 INFO     5 channels OOF AUC without TTA = 0.7610, F1 = 0.4060, precision = 0.2809, recall = 0.7318
2023-11-17 10:35:54,364 INFO     Confusion matrix for 5 channels averaged
2023-11-17 10:35:54,364 INFO [[885  70]
 [489 191]]
2023-11-17 10:35:54,364 INFO     Confusion matrix for 5 channels averaged on the subsample
2023-11-17 10:35:54,368 INFO [[885   3]
 [489  12]]
2023-11-17 10:35:54,368 INFO     Subset 5 channels OOF AUC without TTA = 0.8546, F1 = 0.0465, precision = 0.0240, recall = 0.8000 

